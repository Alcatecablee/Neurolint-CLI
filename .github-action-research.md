# NeuroLint GitHub Action - Codebase Analysis

## 8-Layer Architecture Overview

Based on reading `/home/runner/workspace/cli.js` and layer files:

### Layer Definitions (from cli.js lines 70-79):
```javascript
const LAYER_NAMES = {
  1: 'config',           // Configuration files (tsconfig.json, package.json, next.config.js)
  2: 'patterns',         // Common code patterns (console.log, HTML entities, varâ†’const)
  3: 'components',       // React component fixes (keys, alt, aria-labels)
  4: 'hydration',        // SSR safety (window, document, localStorage guards)
  5: 'nextjs',           // Next.js optimization (use client, deprecated features)
  6: 'testing',          // Testing infrastructure & error boundaries
  7: 'adaptive',         // Adaptive pattern learning from production code
  8: 'security-forensics' // Security detection (CVE, IoCs, behavioral analysis)
};
```

### Layer Files Location:
- Layer 1: `/scripts/fix-layer-1-config.js`
- Layer 2: `/scripts/fix-layer-2-patterns.js`
- Layer 3: `/scripts/fix-layer-3-components.js`
- Layer 4: `/scripts/fix-layer-4-hydration.js`
- Layer 5: `/scripts/fix-layer-5-nextjs.js`
- Layer 6: `/scripts/fix-layer-6-testing.js`
- Layer 7: `/scripts/fix-layer-7-adaptive.js`
- Layer 8: `/scripts/fix-layer-8-security/` (directory with sub-modules)

## CLI Command Structure

### Main Fix Command (cli.js line 3178):
```bash
neurolint fix <target-path> [options]
```

### Layer Selection Options (from cli.js line 721):
```javascript
--layers <numbers>      // Specify which layers to run: 1,2,3,4,5,6,7,8
--all-layers            // Run all 8 layers (shorthand for --layers 1,2,3,4,5,6,7,8)
```

### Other Common Options (cli.js lines 712-724):
```javascript
--dry-run               // Preview changes without applying
--verbose               // Detailed logging
--production            // Use production backup manager
--backup                // Create backups (default: true, use --no-backup to disable)
--include <patterns>    // File patterns to include
--exclude <patterns>    // File patterns to exclude
```

## Default File Patterns

### Default Include (cli.js line 723):
```javascript
'**/*.{ts,tsx,js,jsx,json}'
```

### Default Exclude (cli.js lines 724):
```javascript
'**/node_modules/**'
'**/dist/**'
'**/.next/**'
```

## Key CLI Features for GitHub Action

### Commands Used:
- `neurolint fix` - Main code fixing
- `neurolint analyze` - Analyze issues without fixing
- `neurolint security:scan-compromise` - Security forensics scan
- `neurolint security:cve-2025-55182` - React CVE detection
- `neurolint --help` - Help output

### Output Handling:
From cli.js, the tool supports:
- Console output with spinners
- JSON output format (for parsing in workflows)
- Dry-run preview mode
- Verbose logging for debugging

## What GitHub Action Needs to Support

1. **Layer Selection Input**: Allow users to specify which layers (1-8) to run
   - Single layer: `--layers 1`
   - Multiple layers: `--layers 1,3,5,8`
   - All layers: `--all-layers`
   - Default: All layers

2. **Options Input**:
   - `dry-run`: Preview mode
   - `verbose`: Detailed logging
   - `fail-on-changes`: Fail if changes are detected (strict mode)

3. **File Patterns Input**:
   - Custom include patterns
   - Custom exclude patterns

4. **Output**:
   - Summary of changes made
   - Exit code (0 = success, 1 = failure)
   - JSON report option

## Execution Flow

From cli.js:
1. Parse command line arguments
2. Find files matching include/exclude patterns
3. Run selected layers in sequence
4. Validate changes at each layer
5. Backup files before applying changes
6. Report results

## Environment Variables Used

- `NEUROLINT_PRODUCTION`: Forces production backup manager
- `NODE_ENV`: Environment detection

## Next Steps for GitHub Action

1. Create `action.yml` with inputs for:
   - `layers` (string: "1,2,3,4,5,6,7,8" or "all")
   - `path` (string: target directory)
   - `dry-run` (boolean)
   - `verbose` (boolean)
   - `fail-on-changes` (boolean)
   - Custom include/exclude patterns

2. Create wrapper script that:
   - Calls `npx neurolint fix <path> --layers X,Y,Z`
   - Parses output
   - Sets outputs for downstream use
   - Returns proper exit codes

3. Submit to GitHub Marketplace once tested
