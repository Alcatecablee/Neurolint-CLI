{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://neurolint.dev/schemas/neurolint-baseline.schema.json",
  "title": "NeuroLint Baseline Integrity",
  "description": "Schema for NeuroLint baseline integrity snapshots used for detecting unauthorized file changes and verifying codebase integrity",
  "type": "object",
  "required": ["version", "createdAt", "projectRoot", "files"],
  "properties": {
    "version": {
      "type": "string",
      "description": "Schema version for baseline format",
      "pattern": "^\\d+\\.\\d+$"
    },
    "createdAt": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when baseline was created"
    },
    "updatedAt": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of last baseline update"
    },
    "projectRoot": {
      "type": "string",
      "description": "Absolute path to project root when baseline was created"
    },
    "projectName": {
      "type": "string",
      "description": "Name of the project from package.json"
    },
    "projectVersion": {
      "type": "string",
      "description": "Version of the project when baseline was created"
    },
    "gitCommit": {
      "type": "string",
      "pattern": "^[a-f0-9]{40}$",
      "description": "Git commit SHA when baseline was created"
    },
    "gitBranch": {
      "type": "string",
      "description": "Git branch name when baseline was created"
    },
    "hashAlgorithm": {
      "type": "string",
      "enum": ["sha256", "sha384", "sha512"],
      "default": "sha256",
      "description": "Hash algorithm used for file integrity"
    },
    "summary": {
      "type": "object",
      "properties": {
        "totalFiles": {
          "type": "integer",
          "minimum": 0
        },
        "totalSize": {
          "type": "integer",
          "minimum": 0,
          "description": "Total size of all files in bytes"
        },
        "fileTypes": {
          "type": "object",
          "additionalProperties": {
            "type": "integer"
          },
          "description": "Count of files by extension"
        }
      }
    },
    "excludePatterns": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Glob patterns excluded from baseline",
      "default": ["node_modules/**", ".git/**", "*.log", ".env*"]
    },
    "files": {
      "type": "array",
      "description": "List of tracked files with integrity data",
      "items": {
        "type": "object",
        "required": ["path", "hash", "size"],
        "properties": {
          "path": {
            "type": "string",
            "description": "Relative path from project root"
          },
          "hash": {
            "type": "string",
            "description": "File content hash using specified algorithm"
          },
          "size": {
            "type": "integer",
            "minimum": 0,
            "description": "File size in bytes"
          },
          "mtime": {
            "type": "string",
            "format": "date-time",
            "description": "File modification timestamp"
          },
          "mode": {
            "type": "string",
            "pattern": "^[0-7]{3,4}$",
            "description": "Unix file permissions"
          },
          "type": {
            "type": "string",
            "enum": ["source", "config", "asset", "test", "docs", "other"],
            "description": "File classification for prioritized monitoring"
          },
          "securityRelevant": {
            "type": "boolean",
            "default": false,
            "description": "Whether file is security-critical (auth, crypto, etc.)"
          },
          "contentType": {
            "type": "string",
            "description": "MIME type or file category"
          }
        }
      }
    },
    "securityMarkers": {
      "type": "object",
      "description": "Security-relevant file markers for priority monitoring",
      "properties": {
        "authFiles": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Paths to authentication-related files"
        },
        "cryptoFiles": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Paths to cryptography-related files"
        },
        "configFiles": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Paths to configuration files"
        },
        "serverActions": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Paths to React Server Actions/Components"
        },
        "apiRoutes": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Paths to API route handlers"
        }
      }
    },
    "dependencies": {
      "type": "object",
      "description": "Dependency snapshot for supply chain verification",
      "properties": {
        "lockfileHash": {
          "type": "string",
          "description": "Hash of package-lock.json or yarn.lock"
        },
        "criticalPackages": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": { "type": "string" },
              "version": { "type": "string" },
              "integrity": { "type": "string" }
            }
          },
          "description": "Core framework packages with integrity hashes"
        }
      }
    },
    "metadata": {
      "type": "object",
      "description": "Additional baseline metadata",
      "properties": {
        "createdBy": { "type": "string" },
        "environment": { "type": "string" },
        "notes": { "type": "string" }
      },
      "additionalProperties": true
    }
  }
}
